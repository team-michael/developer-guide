---
title: "React Native 연동"
---

Notifly React Native SDK는 **노티플라이의 푸시 및 인앱 캠페인 기능을 React Native 앱에 통합**할 수 있도록 지원합니다.  
아래 기능을 제공합니다:

- 기기 정보를 노티플라이에 등록하여 **푸시 알림 및 인앱 팝업** 수신  
  (인앱 팝업은 **Foreground 상태**에서만 표시됩니다)
- 이벤트 및 유저 정보를 노티플라이와 연동하여 **캠페인 타깃팅 및 분석 활용**
- 유저 행동 데이터를 기반으로 한 **이벤트 로깅 및 성과 측정**

## Before You Start
 
SDK를 설치하기 전, 아래 과정을 반드시 완료하세요.

1. **Firebase 프로젝트 연동**  
  > 👉 [Firebase 프로젝트 연동 가이드](sdk/firebase-integration.mdx)

2. **iOS APNs 인증 등록**  
  > 👉 [APNs 인증서 등록](https://docs.notifly.tech/ko/developer-guide/client-sdk/firebase_project_setup#1-3-apns-인증서-등록)

<Info>
iOS 13 이상, Android 7.0(API 24) 이상 환경을 권장합니다.  
iOS는 `.xcworkspace` 파일을 반드시 Xcode로 열어야 정상적으로 빌드됩니다.
</Info>

## 1. SDK 설치

### SDK 설치

- [notifly-sdk npm](https://www.npmjs.com/package/notifly-sdk)

<Tabs>
<Tab title="npm">
```shell
npm install notifly-sdk@latest --save
cd ios && pod install
```
</Tab>
<Tab title="yarn">
```shell
yarn add notifly-sdk@latest
cd ios && pod install
```
</Tab>
</Tabs>

<Info> `package.json` 파일에 `notifly-sdk`가 추가됩니다. 현재 최신 버전: [![Npm](https://img.shields.io/npm/v/notifly-sdk.svg)](https://www.npmjs.com/package/notifly-sdk) </Info>

### iOS 설정

#### 1. Capability 설정

1. Xcode에서 `{Your_Project_Name}.xcworkspace`을 엽니다. (`.xcodeproj`로는 노티플라이 SDK 사용 불가)

2. iOS Deployment Target/Target의 Minimum Deployments을 13.0 이상으로 설정하고, Podfile의 최소 버전도 동일하게 지정합니다.

3. Push Notification 및 Background Mode (Remote notification, Background fetch)를 활성화합니다.
   ![Add Capabilities](./image/ios_setting_add_capability1.png)
   ![Add Capabilities](./image/ios_setting_add_capability2.png)

#### 2. `AppDelegate.mm` 설정

1. 파일 위치

`AppDelegate.mm` 파일은 다음 경로에 있습니다:

```
ios/{ProjectName}/AppDelegate.mm
```

2. `notifly_sdk` import 추가

```objc
#import "notifly_sdk-Swift.h"
```

<Info> 이 코드는 Notifly SDK와 Swift 브리지 연결**을 위한 필수 import입니다. </Info>

3. `UNUserNotificationCenterDelegate` 프로토콜 추가

`AppDelegate.h`에서 `AppDelegate` 클래스가 `UNUserNotificationCenterDelegate`를 구현하도록 수정합니다.

<Tabs>
<Tab title="AppDelegate.h"> 
```objc title="header" 
#import <RCTAppDelegate.h> 
#import <UIKit/UIKit.h> 
#import <UserNotifications/UNUserNotificationCenter.h>

@interface AppDelegate : RCTAppDelegate <UNUserNotificationCenterDelegate>

@end
```
</Tab>
</Tabs>

4. `AppDelegate` 메서드 수정

`AppDelegate.mm` 내 메소드(`AppDelegate method`)에 Notifly 관련 코드를 추가합니다.

| 메서드 이름 | 설명 |
|--------------|------|
| `application:didFinishLaunchingWithOptions:` | Firebase 초기화 및 Notification Center delegate 설정 |
| `application:didRegisterForRemoteNotificationsWithDeviceToken:` | APNs 토큰을 Notifly에 등록 |
| `application:didFailToRegisterForRemoteNotificationsWithError:` | APNs 등록 실패 시 Notifly에 알림 |
| `userNotificationCenter:didReceiveNotificationResponse:` | 푸시 알림 클릭 이벤트 전달 |
| `userNotificationCenter:willPresentNotification:` | Foreground 상태의 푸시 표시 처리 |

<Tabs>
<Tab title="AppDelegate.mm">
```objc title="AppDelegate.mm"
#import <Firebase.h>
#import <React/RCTBundleURLProvider.h>
#import "AppDelegate.h"
#import "notifly_sdk-Swift.h"

@implementation AppDelegate

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {
    [FIRApp configure];
    UNUserNotificationCenter *center = [UNUserNotificationCenter currentNotificationCenter];
    center.delegate = self;
    [[UIApplication sharedApplication] registerForRemoteNotifications];
    return YES;
}

- (void)application:(UIApplication *)application didRegisterForRemoteNotificationsWithDeviceToken:(NSData *)deviceToken {
    [Notifly application:application didRegisterForRemoteNotificationsWithDeviceToken:deviceToken];
}

- (void)application:(UIApplication *)application didFailToRegisterForRemoteNotificationsWithError:(NSError *)error {
    [Notifly application:application didFailToRegisterForRemoteNotificationsWithError:error];
}

- (void)userNotificationCenter:(UNUserNotificationCenter *)center didReceiveNotificationResponse:(UNNotificationResponse *)response withCompletionHandler:(void (^)(void))completionHandler {
    [Notifly userNotificationCenter:center didReceive:response];
    completionHandler();
}

- (void)userNotificationCenter:(UNUserNotificationCenter *)center willPresentNotification:(UNNotification *)notification withCompletionHandler:(void (^)(UNNotificationPresentationOptions options))completionHandler {
    [Notifly userNotificationCenter:center willPresent:notification withCompletionHandler:completionHandler];
}

@end
```
</Tab>
</Tabs>

### (선택) iOS Notification Service Extension 설정

<Info> `notifly-sdk` 버전 3.0.4 이상부터 지원됩니다. </Info>

Notification Service Extension을 설정하면 리치 푸시(Rich Push) 기능을 사용할 수 있습니다. Notifly의 [Push Extension 가이드](advanced/rich-push-notification)를 참고해 설정하세요.

#### 주요 기능

1. 푸시 알림에 이미지 및 비디오 첨부 가능
2. 유저의 푸시 수신 여부를 추적하여 캠페인 성과를 세부적으로 분석 가능

<Warning> Notification Service Extension 설정을 하지 않아도 SDK는 정상 동작하지만, 리치 푸시 및 수신 트래킹은 사용할 수 없습니다. </Warning>

### 초기화 코드 추가

앱 진입점(`index.js` 또는 `App.js`)에 초기화 코드를 추가합니다.

```js title="index.js"
...
import notifly from 'notifly-sdk';

/* Your Code */

notifly.initialize({
  projectId: 'myProjectId',
  username: 'myUserName',
  password: 'myPassword',
});

/* Your Code */

AppRegistry.registerComponent(...);
```

<Info> `projectId`, `username`, `password`는 Notifly 관리자 페이지에서 확인할 수 있습니다. </Info>

## 2. 유저 정보 등록

Notifly는 유저 식별자(`userId`)와 유저 프로퍼티(`params`)를 기반으로 개인화 마케팅 캠페인을 수행합니다.  
등록된 유저 정보는 세그먼트 분류, 푸시 발송, 이메일 및 카카오 알림톡 등의 타깃팅에 활용됩니다.

### 1. 유저 ID 등록 (`Notifly.setUserId()`)

`userId`는 앱 내부의 로그인 사용자 식별자와 매핑됩니다.  
Notifly는 이 값을 기준으로 사용자 이벤트를 추적하고 캠페인을 개인화합니다.

### Parameters

<ParamField path="userId" type="String" required>
  로그인 사용자 ID. 로그아웃 시 `null`로 설정하여 해제
</ParamField>

```js
notifly.setUserId(userId);
```

---

<Warning>
`setUserId(null)`을 호출하면 해당 유저의 프로퍼티, 캠페인 히스토리, 피로도 데이터가 **모두 삭제됩니다.**  
로그아웃 시점에만 호출하세요.
</Warning>

<Tabs>
<Tab title="JavaScript">
```js title="setUserId JavaScript"
const handleLogin = () => {
    ...
    notifly.setUserId('example_user_id'); // Set User Id
    ...
}

const handleLogout = () => {
    ...
    notifly.setUserId(); // Unregister User Id
    ...
}
```
</Tab>
</Tabs>

### 2. 유저 프로퍼티 등록

`setUserProperties`는 사용자의 속성 정보를 등록합니다.  
이 정보는 **세그먼트 타깃팅**, **메시지 개인화**, **발송 채널 선택** 등에 사용됩니다.

```js
notifly.setUserProperties(params);
```

<ParamField path="param" type="Object" required>
  사용자 속성 key-value 쌍. `$email`, `$phone_number` 등 사전 정의된 키 지원
</ParamField>

<Info>
- `$email` : 이메일 캠페인용 주소  
- `$phone_number` : 문자/카카오 캠페인용 전화번호  
- 기타 커스텀 필드: `"plan"`, `"tier"`, `"country"` 등 자유롭게 설정 가능  
</Info>

<Tabs>
<Tab title="JavaScript">

```js title="setUserProperties"
const handleRejectPushNotification = () => {
    ...
    notifly.setUserProperties({
        "push_subscription_channel1": false,
        "push_subscription_channel2": false,
        "push_subscription_channel3": false,
    });
    ...
}
```

</Tab>
</Tabs>

## 3. 이벤트 로깅

유저 행동을 기록하여 **캠페인 트리거**, **세그먼트 조건**, **성과 분석** 등에 활용할 수 있습니다.  
예를 들어 버튼 클릭, 페이지 진입, 구매 완료 같은 사용자 행동을 이벤트로 수집합니다.

```js
notifly.trackEvent(eventName, eventParams, segmentationEventParamKeys);
```

### Parameters

<ParamField path="eventName" type="String" required>
  이벤트 이름 (예: "click_button", "purchase_completed")
</ParamField>
<ParamField path="eventParams" type="Object">
  이벤트에 대한 추가 속성. 예: "plan": "premium", "duration": 120
</ParamField>
<ParamField path="segmentationEventParamKeys" type="List<String>">
  세그먼트 분류 시 기준으로 사용할 키 목록 (최대 1개까지 지원)
</ParamField>

<Info>
`segmentationEventParamKeys`를 활용하여 이벤트 변수 (eventParams)를 발송 대상 설정 등에 활용할 수 있습니다. **최대 1개의 Key**만 지정할 수 있습니다.
</Info>

<Tabs>
<Tab title="JavaScript" >

```js title="trackEvent"
const handlePurchaseTicket = () => {
    ...
    notifly.trackEvent("ticket_purchase", {
        "show_id": "sample_show_id",
        "performance_start_time": 1674104659
    }, ["show_id"]);
    ...
}

const handleLogin = () => {
    ...
    notifly.trackEvent("login");
    ...
}
```

</Tab>
</Tabs>

## 4. 연동 테스트

SDK 설치 후 아래 페이지에서 실제 이벤트 및 푸시 수신 여부를 테스트하세요.  
👉 [Client SDK - 연동 Test](https://docs.notifly.tech/ko/developer-guide/client-sdk/sdk_test)

## 5. 심화 연동

<Columns cols={2}>

  <Card
    title="Push Icon & Consent"
    icon="bell"
    href="/sdk/android-advanced#push-icon-consent"
  >
    푸시 알림 아이콘 등록 (Android) & 푸시 알림 동의 프롬프트
  </Card>

  <Card
    title="Click Event Subscription"
    icon="mouse-pointer"
    href="/sdk/android-advanced#click-event"
  >
    푸시 알림 클릭 이벤트 구독
  </Card>

</Columns>

## FAQ

<AccordionGroup>
  <Accordion title="이미 Firebase Cloud Messaging을 사용 중인데 어떻게 해야 할까요?">
    Notifly Android SDK는 기존 앱에서 사용하고 있을 수 있는 Firebase Cloud Messaging과 함께 사용하실 수 있습니다.
  </Accordion>

  <Accordion title="Build시 AppDelegate.mm 파일에서 Notifly 클래스 관련 에러가 발생합니다.">
    Podfile에 `use_frameworks! :linkage => :static` 라인을 추가하여 Static Linking을 시도해주세요. (기존에 `use_frameworks!` 라인이 존재한다면, `:linkage => :static` 옵션만 추가해주세요.)
  </Accordion>

  <Accordion title="iOS기기에서 Foreground 상태에서 푸시 알림이 오지 않습니다.">
    Firebase Messaging을 이미 사용하시고 계시다면, firebase.json 파일에 아래 안내에 따라 설정해주세요.
    
    [React Native Firebase의 Foreground Presentation Options](https://rnfirebase.io/messaging/usage#foreground-presentation-options-ios)의 가이드에 따라 firebase.json 파일에 다음 코드를 추가해주세요.
    
    ```json
    {
      "react-native": {
        "messaging_ios_foreground_presentation_options": [
          "badge",
          "sound",
          "list",
          "banner"
        ]
      }
    }
    ```
  </Accordion>

  <Accordion title="`notifly_sdk-Swift.h` 파일을 찾을 수 없다는 에러가 뜹니다">
    - notifly_sdk(ios)는 Swift로 작성되어 있습니다. 이에 Objective-C 환경으로 노출시키기 위해 빌드되는 과정에서 Swift Compatibility Header가 생성되는데, 이 헤더 파일의 이름이 notifly_sdk-Swift.h입니다. 빌드를 진행하고자하는 타겟의 Builld Option의 Header Search Paths에 "${PODS_CONFIGURATION_BUILD_DIR}"를 추가해주세요.
    - [참고](https://developer.apple.com/documentation/swift/importing-swift-into-objective-c)
  </Accordion>
</AccordionGroup>
